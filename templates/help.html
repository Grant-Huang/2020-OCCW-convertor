{% extends "base.html" %}

{% block title %}{{ t('help_title') }} - {{ t('system_name') }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- 页面标题 -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex align-items-center">
                <i class="fas fa-question-circle fa-2x text-primary me-3"></i>
                <div>
                    <h2 class="mb-0">{{ t('help_title') }}</h2>
                    <p class="text-muted mb-0">{{ t('system_name') }} {{ t('help_usage_guide') }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 快速导航 -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-map me-2"></i>{{ t('help_usage_guide') }}</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <a href="#overview" class="btn btn-outline-primary btn-sm w-100 mb-2">
                                <i class="fas fa-info-circle me-1"></i>{{ t('help_system_intro') }}
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="#workflow" class="btn btn-outline-primary btn-sm w-100 mb-2">
                                <i class="fas fa-flow-chart me-1"></i>{{ t('help_usage_guide') }}
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="#features" class="btn btn-outline-primary btn-sm w-100 mb-2">
                                <i class="fas fa-cogs me-1"></i>{{ t('help_main_features') }}
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="#troubleshooting" class="btn btn-outline-primary btn-sm w-100 mb-2">
                                <i class="fas fa-tools me-1"></i>{{ t('help_technical_support') }}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 系统概述 -->
    <div class="row mb-4" id="overview">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>{{ t('help_system_intro') }}</h5>
                </div>
                <div class="card-body">
                    <h6 class="text-primary">{{ t('help_system_intro') }}</h6>
                    <p>{{ t('help_system_intro_desc') }}</p>
                    
                    <div class="alert alert-info">
                        <h6 class="alert-heading"><i class="fas fa-shield-alt me-2"></i>{{ t('help_permissions') }}</h6>
                        <p class="mb-2"><strong>{{ t('help_normal_users') }}</strong>：{{ t('help_normal_users_desc') }}</p>
                        <p class="mb-0"><strong>{{ t('help_admin_users') }}</strong>：{{ t('help_admin_users_desc') }}</p>
                    </div>
                    
                    <h6 class="text-primary mt-4">{{ t('help_main_functionality') }}</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i>{{ t('help_pdf_upload_desc') }}</li>
                                <li><i class="fas fa-check text-success me-2"></i>{{ t('help_sku_generation_desc') }}</li>
                                <li><i class="fas fa-check text-success me-2"></i>{{ t('help_price_management_desc') }}</li>
                                <li><i class="fas fa-check text-success me-2"></i>{{ t('help_multi_export_desc') }}</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i>{{ t('help_multilang_desc') }}</li>
                                <li><i class="fas fa-check text-success me-2"></i>{{ t('help_auto_parse_desc') }}</li>
                                <li><i class="fas fa-check text-success me-2"></i>{{ t('help_sku_generation_desc') }}</li>
                                <li><i class="fas fa-check text-success me-2"></i>{{ t('help_price_management_desc') }}</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 使用流程 -->
    <div class="row mb-4" id="workflow">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-flow-chart me-2"></i>{{ t('help_usage_guide') }}</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="timeline">
                                <div class="timeline-item">
                                    <div class="timeline-marker bg-primary">1</div>
                                    <div class="timeline-content">
                                        <h6 class="text-primary">{{ t('help_step1') }}</h6>
                                        <p>{{ t('help_step1_desc') }}</p>
                                    </div>
                                </div>
                                
                                <div class="timeline-item">
                                    <div class="timeline-marker bg-info">2</div>
                                    <div class="timeline-content">
                                        <h6 class="text-info">{{ t('help_step2') }}</h6>
                                        <p>{{ t('help_step2_desc') }}</p>
                                    </div>
                                </div>
                                
                                <div class="timeline-item">
                                    <div class="timeline-marker bg-warning">3</div>
                                    <div class="timeline-content">
                                        <h6 class="text-warning">{{ t('help_step3') }}</h6>
                                        <p>{{ t('help_step3_desc') }}</p>
                                    </div>
                                </div>
                                
                                <div class="timeline-item">
                                    <div class="timeline-marker bg-success">4</div>
                                    <div class="timeline-content">
                                        <h6 class="text-success">{{ t('help_step4') }}</h6>
                                        <p>{{ t('help_step4_desc') }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 功能详解 -->
    <div class="row mb-4" id="features">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>{{ t('help_main_features') }}</h5>
                </div>
                <div class="card-body">
                    <div class="accordion" id="featuresAccordion">
                        <!-- PDF解析功能 -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="pdfParsing">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePdfParsing">
                                    <i class="fas fa-file-pdf me-2"></i>{{ t('help_pdf_upload') }}
                                </button>
                            </h2>
                            <div id="collapsePdfParsing" class="accordion-collapse collapse show" data-bs-parent="#featuresAccordion">
                                <div class="accordion-body">
                                    <h6>{{ t('parse_content') }}：</h6>
                                    <ul>
                                        <li><strong>{{ t('product_information') }}</strong>：{{ t('product_code_desc_seq') }}</li>
                                        <li><strong>{{ t('quantity_data') }}</strong>：{{ t('smart_extract_qty_user') }}</li>
                                        <li><strong>{{ t('price_information') }}</strong>：{{ t('unit_price_total_price') }}</li>
                                        <li><strong>{{ t('door_color') }}</strong>：{{ t('auto_recognize_door_style') }}</li>
                                        <li><strong>{{ t('total_price_verification') }}</strong>：{{ t('compare_with_pdf_total') }}</li>
                                    </ul>
                                    
                                    <h6 class="mt-3">{{ t('special_processing') }}：</h6>
                                    <ul>
                                        <li>{{ t('smart_distinguish_product_codes') }}</li>
                                        <li>{{ t('auto_handle_page_separators') }}</li>
                                        <li>{{ t('support_multi_page_pdf') }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- SKU生成规则 -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="skuRules">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSkuRules">
                                    <i class="fas fa-code me-2"></i>{{ t('sku_generation_rules') }}
                                </button>
                            </h2>
                            <div id="collapseSkuRules" class="accordion-collapse collapse" data-bs-parent="#featuresAccordion">
                                <div class="accordion-body">
                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead class="table-dark">
                                                <tr>
                                                    <th>{{ t('product_type') }}</th>
                                                    <th>{{ t('judgment_condition') }}</th>
                                                    <th>{{ t('sku_generation_rule') }}</th>
                                                    <th>{{ t('example') }}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><span class="badge bg-primary">{{ t('cabinet') }}</span></td>
                                                    <td>{{ t('description_contains_cabinet') }}</td>
                                                    <td><code>{{ t('occw_code_ply_color') }}</code></td>
                                                    <td><code>W3036-PLY-SSW</code></td>
                                                </tr>
                                                <tr>
                                                    <td><span class="badge bg-info">{{ t('hardware') }}</span></td>
                                                    <td>{{ t('description_contains_hardware') }}</td>
                                                    <td><code>{{ t('hw_user_code') }}</code></td>
                                                    <td><code>HW-H123</code></td>
                                                </tr>
                                                <tr>
                                                    <td><span class="badge bg-warning">{{ t('accessory') }}</span></td>
                                                    <td>{{ t('description_contains_accessory') }}</td>
                                                    <td><code>{{ t('color_user_code') }}</code></td>
                                                    <td><code>SSW-ACC001</code></td>
                                                </tr>
                                                <tr>
                                                    <td><span class="badge bg-secondary">{{ t('other') }}</span></td>
                                                    <td>{{ t('not_meet_above_conditions') }}</td>
                                                    <td><code>{{ t('color_user_code') }}</code></td>
                                                    <td><code>SSW-MISC001</code></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    
                                    <div class="alert alert-info mt-3">
                                        <i class="fas fa-info-circle me-2"></i>
                                        <strong>{{ t('note') }}：</strong>{{ t('sku_rules_customizable') }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 价格管理 -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="priceManagement">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePriceManagement">
                                    <i class="fas fa-dollar-sign me-2"></i>{{ t('price_management') }}
                                </button>
                            </h2>
                            <div id="collapsePriceManagement" class="accordion-collapse collapse" data-bs-parent="#featuresAccordion">
                                <div class="accordion-body">
                                    <h6>{{ t('occw_price_table_management') }}：</h6>
                                    <ul>
                                        <li><strong>{{ t('batch_import') }}</strong>：{{ t('support_excel_batch_import') }}</li>
                                        <li><strong>{{ t('manual_add') }}</strong>：{{ t('manually_add_single_sku') }}</li>
                                        <li><strong>{{ t('real_time_update') }}</strong>：{{ t('modify_price_immediately_effective') }}</li>
                                        <li><strong>{{ t('data_export') }}</strong>：{{ t('export_price_table_excel_csv') }}</li>
                                        <li><strong>{{ t('data_validation') }}</strong>：{{ t('auto_check_duplicate_sku') }}</li>
                                    </ul>
                                    
                                    <h6 class="mt-3">{{ t('excel_import_format_requirements') }}：</h6>
                                    <div class="table-responsive">
                                        <table class="table table-sm table-bordered">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>{{ t('column_name') }}</th>
                                                    <th>{{ t('data_type') }}</th>
                                                    <th>{{ t('description') }}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>{{ t('internal_reference_number') }}</td>
                                                    <td>{{ t('text') }}</td>
                                                    <td>{{ t('system_sku_identifier') }}</td>
                                                </tr>
                                                <tr>
                                                    <td>{{ t('selling_price') }}</td>
                                                    <td>{{ t('number') }}</td>
                                                    <td>{{ t('product_price_must_be_positive') }}</td>
                                                </tr>
                                                <tr>
                                                    <td>{{ t('variant_value') }}</td>
                                                    <td>{{ t('text') }}</td>
                                                    <td>{{ t('door_or_box_variant_format') }}</td>
                                                </tr>
                                                <tr>
                                                    <td>{{ t('name') }}</td>
                                                    <td>{{ t('text') }}</td>
                                                    <td>{{ t('product_name_cannot_be_empty') }}</td>
                                                </tr>
                                                <tr>
                                                    <td>{{ t('product_category_name') }}</td>
                                                    <td>{{ t('text') }}</td>
                                                    <td>{{ t('product_classification_support') }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- SKU映射管理 -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="skuMapping">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSkuMapping">
                                    <i class="fas fa-exchange-alt me-2"></i>{{ t('sku_mapping_management') }}
                                </button>
                            </h2>
                            <div id="collapseSkuMapping" class="accordion-collapse collapse" data-bs-parent="#featuresAccordion">
                                <div class="accordion-body">
                                    <h6>{{ t('mapping_mechanism') }}：</h6>
                                    <p>{{ t('when_system_generated_sku_not_found') }}</p>
                                    <ul>
                                        <li><strong>{{ t('dropdown_selection') }}</strong>：{{ t('display_related_sku_list') }}</li>
                                        <li><strong>{{ t('manual_input') }}</strong>：{{ t('provide_text_input_when_no_related_sku') }}</li>
                                        <li><strong>{{ t('mapping_save') }}</strong>：{{ t('auto_save_mapping_relationship') }}</li>
                                    </ul>
                                    
                                    <h6 class="mt-3">{{ t('mapping_management_features') }}：</h6>
                                    <ul>
                                        <li><strong>{{ t('view_all_mappings') }}</strong>：{{ t('view_all_saved_mappings') }}</li>
                                        <li><strong>{{ t('edit_mapping') }}</strong>：{{ t('modify_existing_mapping_relationship') }}</li>
                                        <li><strong>{{ t('delete_mapping') }}</strong>：{{ t('delete_unnecessary_mapping_relationship') }}</li>
                                        <li><strong>{{ t('batch_management') }}</strong>：{{ t('support_batch_delete_and_modify') }}</li>
                                    </ul>
                                    
                                    <div class="alert alert-warning mt-3">
                                        <i class="fas fa-exclamation-triangle me-2"></i>
                                        <strong>{{ t('tip') }}：</strong>{{ t('mapping_relationship_display_note') }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 导出功能 -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="exportFeatures">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExportFeatures">
                                    <i class="fas fa-download me-2"></i>{{ t('export_features') }}
                                </button>
                            </h2>
                            <div id="collapseExportFeatures" class="accordion-collapse collapse" data-bs-parent="#featuresAccordion">
                                <div class="accordion-body">
                                    <h6>{{ t('supported_export_formats') }}：</h6>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6 class="text-primary">{{ t('format_2020_export') }}：</h6>
                                            <ul>
                                                <li><strong>{{ t('excel_xlsx') }}</strong>：{{ t('contains_all_column_information') }}</li>
                                                <li><strong>{{ t('csv_format') }}</strong>：{{ t('plain_text_format') }}</li>
                                                <li><strong>{{ t('pdf_format') }}</strong>：{{ t('professional_print_format') }}</li>
                                            </ul>
                                            <p><small class="text-muted">{{ t('contains_sequence_code_quantity') }}</small></p>
                                        </div>
                                        <div class="col-md-6">
                                            <h6 class="text-success">{{ t('occw_format_export') }}：</h6>
                                            <ul>
                                                <li><strong>{{ t('excel_xlsx') }}</strong>：{{ t('special_occw_quote_format') }}</li>
                                            </ul>
                                            <p><small class="text-muted">{{ t('contains_sequence_occw_sku') }}</small></p>
                                        </div>
                                    </div>
                                    
                                    <h6 class="mt-3">{{ t('export_features_title') }}：</h6>
                                    <ul>
                                        <li>{{ t('auto_add_total_row') }}</li>
                                        <li>{{ t('maintain_number_format') }}</li>
                                        <li>{{ t('support_chinese_filename') }}</li>
                                        <li>{{ t('file_size_optimization') }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 问题解决 -->
    <div class="row mb-4" id="troubleshooting">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-tools me-2"></i>{{ t('common_problem_solving_title') }}</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-danger">{{ t('pdf_parsing_issues') }}</h6>
                            <div class="card bg-light mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">{{ t('pdf_upload_parse_error_question') }}</h6>
                                    <p class="card-text">
                                        <strong>{{ t('solution') }}：</strong><br>
                                        {{ t('confirm_pdf_from_2020') }}<br>
                                        {{ t('check_pdf_corruption') }}<br>
                                        {{ t('use_show_raw_text') }}<br>
                                        {{ t('confirm_complete_product_list') }}
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card bg-light mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">{{ t('product_quantity_price_error_question') }}</h6>
                                    <p class="card-text">
                                        <strong>{{ t('solution') }}：</strong><br>
                                        {{ t('check_pdf_format') }}<br>
                                        {{ t('confirm_merged_column_format') }}<br>
                                        {{ t('view_total_price_comparison') }}<br>
                                        {{ t('manually_correct_data') }}
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h6 class="text-warning">{{ t('sku_and_price_issues') }}</h6>
                            <div class="card bg-light mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">{{ t('occw_price_zero_question') }}</h6>
                                    <p class="card-text">
                                        <strong>{{ t('solution') }}：</strong><br>
                                        {{ t('check_occw_price_table') }}<br>
                                        {{ t('confirm_sku_mapping') }}<br>
                                        {{ t('manually_add_missing_sku') }}<br>
                                        {{ t('check_sku_format') }}
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card bg-light mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">{{ t('sku_no_match_question') }}</h6>
                                    <p class="card-text">
                                        <strong>{{ t('solution') }}：</strong><br>
                                        {{ t('use_similar_sku_dropdown') }}<br>
                                        {{ t('manually_input_correct_sku') }}<br>
                                        {{ t('adjust_sku_generation_rules') }}<br>
                                        {{ t('contact_admin_update_price') }}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <h6 class="text-info mt-4">{{ t('performance_optimization_title') }}</h6>
                    <div class="alert alert-info">
                        <ul class="mb-0">
                            <li>{{ t('regularly_clean_sku_mappings') }}</li>
                            <li>{{ t('keep_occw_price_table_updated') }}</li>
                            <li>{{ t('use_standard_pdf_format') }}</li>
                            <li>{{ t('large_file_processing_patience') }}</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 联系支持 -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-primary">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-headset me-2"></i>{{ t('help_technical_support') }}</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-12">
                            <h6 class="text-primary">{{ t('help_contact_info') }}</h6>
                            <p>{{ t('help_company_full') }}</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="text-center">
                                <i class="fas fa-envelope fa-2x text-primary mb-2"></i>
                                <h6>{{ t('help_email_support') }}</h6>
                                <p class="text-muted"><code>info@oppeincabinet.ca</code></p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="text-center">
                                <i class="fas fa-phone fa-2x text-success mb-2"></i>
                                <h6>{{ t('help_phone_support') }}</h6>
                                <p class="text-muted"><code>+1 (778) 532-6233</code></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 版本信息 -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="alert alert-light">
                                <h6 class="alert-heading">{{ t('help_version_info') }}</h6>
                                <p class="mb-0">{{ t('help_current_version') }}: <strong>{{ version }}</strong></p>
                                <small class="text-muted">{{ t('help_company_name') }} - {{ t('company_full_name') }}</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* 时间轴样式 */
.timeline {
    position: relative;
    padding-left: 50px;
}

.timeline-item {
    position: relative;
    margin-bottom: 30px;
}

.timeline-item:before {
    content: '';
    position: absolute;
    left: -32px;
    top: 30px;
    height: calc(100% + 10px);
    width: 2px;
    background-color: #dee2e6;
}

.timeline-item:last-child:before {
    display: none;
}

.timeline-marker {
    position: absolute;
    left: -42px;
    top: 0;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    font-size: 14px;
}

.timeline-content {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    border-left: 3px solid #007bff;
}

/* 平滑滚动 */
html {
    scroll-behavior: smooth;
}

/* 代码样式 */
code {
    background-color: #f8f9fa;
    padding: 2px 4px;
    border-radius: 3px;
    font-size: 87.5%;
}
</style>
{% endblock %} 